# Linux

## VMware 

### 网络连接模式

#### 桥接模式

虚拟机通过主机的网络适配器连接到外部网络，占用局域网中的IP，可以与其他终端相互访问。

##### NAT（Network Address Translation）

使用NAT模式网络连接时，VMware会在主机上建立单独的专用网络，用以在主机和虚拟机之间相互通信。虚拟机可以通过主机访问外部地址，但外部无法访问虚拟机。此外，在一台主机上只允许有一个NAT模式的虚拟网络。因此，同一台主机上的多个采用NAT模式网络连接的虚拟机也是可以相互访问的。

##### 仅主机模式

仅主机模式，是一种比NAT模式更加封闭的的网络连接模式，它将创建完全包含在主机中的专用网络。仅主机模式的虚拟网络适配器仅对主机可见，并在虚拟机和主机系统之间提供网络连接。

### 虚拟机克隆

- 直接拷贝安装好的虚拟机文件
- 使用VM的克隆操作

### 虚拟机快照

### VM tools

用于共享主机上的文件

## 目录结构

树形，最上层为根目录“/”。

- /bin 是Binary 的缩写，存放系统管理员使用的命令
- /boot 存放的是启动Linux时使用的一些核心文件，包括一些连接文件以及镜像文件。
- /dev 类似于windows的设备管理器，把所有的硬件用文件的形式存储
- /etc 所有系统管理所需要的配置文件和子目录
- /sbin 系统管理员使用的系统管理程序
- /home 存放普通用户的主目录，一般以用户的账号命名
- /root 系统管理员，也称作超级权限者的用户主目录
- /lib 系统开机所需要最基本的动态连接共享库
- /lost + found 一般是空的，当系统非法关机后，会存放文件
- /usr 用户应用程序和文件存放的目录，类似windows下的program files
  - /usr/local 提供给主机额外安装软件的目录，一般是通过编译源码方式安装的程序
  - /usr/bin
  - /usr/lib
- /proc 虚拟目录，是系统内存的映射，访问这个目录来获取系统信息
- /srv service 缩写，该目录从存放一些服务启动之后需要提取的数据
- /sys 这是linux2.6 内核的一个很大的变化，该目录下安装了2.6内核中新出现的一个文件系统sysfs。
- /tmp 这个目录是用来存放一些临时文件的
- /media linux 系统会自动识别以下设备，如U盘、光驱等等，当识别后，linux会把识别的设备挂载该目录
- /mnt 系统提供该目录为用户挂载别的文件系统
- /opt 这是给主机安装软件所摆放的目录。
- /var 习惯将经常修改的目录放在这个目录下。

## 指令

### VIM

[vim教程](https://www.jianshu.com/p/bcbe916f97e1)

![img](D:\project\笔记\操作系统\pic\1-1P9141F35R32.jpg)

### 关机&重启

```
shutdown -h now 立即关机
shutdown -h 1 1min后关机
shutdown -r now 立即重启
halt 关机，同上
reboot 重启
sync 将内存中的数据写入磁盘，永久化
```

### 用户登陆和注销

普通用户登陆后可以使用`su - 用户名`切换成系统管理员身份

切换到root 后，`logout`回到普通用户，图形界面不生效。

xshell 登陆时用户名小写。

### 用户管理

#### 用户的创建和删除：

`useradd 用户名` 会自动创建和用户同名的家目录

`useradd -d 指定目录 新的用户名` 给创建的用户指定家目录

`passwd 用户名` 设置密码

`userdel` 删除用户 ：保留家目录

`userdel` -r 删除用户 : 删除用户和家目录 

#### 查询用户信息

`id 用户名`

`su - 用户名`切换成其他用户（su = switch user）

`logout`返回原用户

`who am i` 或 `who -m`查看最初登陆用户信息

#### 用户组

`groupadd 组名` ：创建组

`groupdel 组名`：删除组

`useradd -g 用户组 用户名` ：创建用户的同时分配组，直接点`useradd` 则是单独一组。

`usermod -g 用户组 用户名` ：修改用户组

### 运行级别

运行级别说明：

0：关机

1：单用户【找回丢失的密码】

2：多用户状态没有网络服务

**3：多用户状态有网络服务**

4：系统未使用保留给用户

**5：图形界面**

6：系统重启

`init[运行级别]`: 切换运行级别

`systemctl get_default`: 获取当前运行级别

`systemctl set_default XXX.target`: `graphical`、`multi-user`

### 帮助指令

`man 命令或配置文件`

### 文件目录类

#### 显示信息

`pwd指令`：（Print Working Directory）显示当前工作目录的绝对路径

`ls`: 列出当前目录下的文件和目录

常用选项 ：

- -a：列出包含隐藏文件、目录的所有文件和目录
- -l：以列表的方式显示信息
- -h: 以人类熟悉的方式显示文件大小

#### 操作目录

##### 切换目录

`cd ~` 或 `cd`: （Change Directory）回到自己的家目录

`cd..` : 回到上级目录

##### 创建目录

`mkdir 路径名`

常用选项 ：

​	-p : 创建多级目录

##### 删除目录

`rmdir 路径名`：删除指定的空目录

`rm -rf` : 递归删除某路径

##### 软连接/符号链接

`ln -s 原文件或目录 软连接名` 

`rm 连接名`：删除软连接



#### 操作文件

##### 创建文件

`touch 文件名称`：创建一个空文件

##### 复制文件

`cp source dest` : 将源文件拷贝到目标文件夹。

常用指令 -r : 递归地拷贝，复制目录

`\cp` ：覆盖不提示。

`rm 文件索引` ： 删除文件

常用指令 -f : 删除不提示

##### 移动

`mv source targer`:

- 源是文件，目标是文件：作为目标文件移动到目标文件夹，如果目标文件夹和源文件夹是一个，则是重命名。
- 目标是目录，将文件或目录移动到另一个目录下。

##### 查看

`cat 文件名`：只能查看不能修改。（英文全拼：concatenate）命令用于**连接文件并打印到标准输出设备上**。.

常用选项：

- -n : 显示行号
- 一般加上管道命令 | more 控制显示的行数

`less 目标文件`: 根据显示情况加载，适合加载大文件

`head` 显示文件的开头部分，默认显示前十行

常用选项：

- -n:`head -n 5` 显示前五行

`tail` 显示文件的末尾部分，默认显示后十行

常用选项：

- -n :`tail -n 5` 显示后五行
- -f  : 实时追踪文件变化



`echo` 输出内容到控制台

常用：

- $PATH 
- $HOSTNAME

`>` 输出重定向 ： `echo "hello" > target` 写入到目标文件（覆盖写）

`>>` : 追加写

用例：（文件不存在会自动创建）

```shell
ls -l > 文件
ls -al >> 文件
cat 文件1 > 文件2
echo "内容" >> 文件
```



`history num` ： 查看历史命令, 不加数字默认查看所有

`!index` ： 执行编号为index的历史命令

### 时间日期类

`date "+%Y-%m-%d %H:%M%S"`  

`data -s 字符串时间` ： 设置当前系统时间

`cal`默认显示本年日历

`cal 2022` 显示某年日历

### 搜索查找类

`find target 选项`

- -user ： `find target -user nobody` 查找属于指定用户的所有文件
- -name: `find target -name *.txt` 按照指定的文件名查找模式查找文件
- -size :  `find target -size +200M` 按照指定的文件大小查找文件（单位K、M、G ，+ 大于， - 小于 ，默认为等于）

---

`locate` 在自建的数据库中查找，查询速度快

执行前需要先执行`updatedb`

---

`which` 查看指令的位置

---

`grep 选项 查找内容 源文件`: 查找文件里符合条件的字符串

- -n : 显示行号
- -i : 忽略大小写

可以配合管道使用， 也可以单独使用。例：

```shell
cat 源文件 | grep "xxx" 
grep -n  "xxx" 原文件
```

### 压缩和解压缩

在本文件夹中操作

`gzip` 压缩成 .gz 格式的文件

`gunzip`

---

`zip`:

- -r : 递归压缩，即压缩目录

`unzip`

- -d: 解压到指定目录

---

`tar`：压缩后的格式是 `.tar.gz`

- -c :  打包

- -x : 解包

- -v : 显示详细信息

- -f : 指定文件

- -z : 用gzip压缩或解压

  

source1 可以是文件也可以是目录，压缩为target

```shell
tar -zcvf file.tar.gz source1 source2
```

解压到当前目录

```shell
tar -zxvf file.tar.gz
```

解压到指定目录

```
tar -zxvf file.tar.gz  -C 目标目录
```

### 组管理和权限管理

#### 改变文件用户所有者

`chown 用户名 文件名`

`chown 用户名:用户组 文件名`

-R 如果是目录，递归生效

#### 修改文件所在组

`chgrp 组名 文件名`

-R 如果是目录，递归生效

#### 修改用户所在组

`usermod -g 新组名 用户名`

`usermod -d 目录名 用户名` : 改变该用户登录的初始目录, 用户需要有该目录的权限

### 权限的基本介绍

-rwxrw-r--  3  root  root  4.0k  4月  7  22 ：25

第一列 （共十位）

1. 第0位确定文件类型 ： d（目录）、- 、 l（链接）、 c（字符设备文件，如鼠标、键盘）、 b（块设备，如硬盘）

2. 第1-3位确定所有者（该文件的所有者）拥有该文件的权限 ---User

3. 第4-6位确定所属组（同用户组）拥有该文件的权限 ---Group

4. 第7-9位确定其他组（非同用户组）拥有的该文件的权限。

   

   对目录有写权限，代表可以在目录内创建、删除或重命名目录。

rwx可用数字表示 r=4, w=2, x=1 因此rwx = 4+2+1 = 7

第二列：表示所包含的文件和目录数。

第三列： 所有者

第四列： 所有组

第五列：文件大小

第六列：最后修改日期

第七列：文件名 

#### 修改权限

`+`、`-`、`=` 变更权限

u: 所有者 g:所有组 o:其他人 a:所有人

- `chmod u=rwx,g=rx,o=x 文件/目录名`

- `chomd o+w 文件/目录名`

- `chmod a-x 文件/目录名`

  

r = 4, w = 2, x = 1

`chmod u=rwd, g=rx, o=x 文件目录名`

相当于`chmod 751 文件目录名`

### crond 任务调度

`crontab` 进行 定时任务调度

- -e ： 编辑 crontab 定时任务
- -l ： 查询 crontab 任务
- -r : 删除当前用户的所有crontab 任务

`* * * * * 命令`

- `*`：表示任何时间，如第一个`*`代表一小时每分钟都执行一次
- `,`：代表不连续时间，如 `0 8,12,16 * * * 命令`代表在每天的八点0分，12点0分，16点0分都执行一次命令。
- `-`：代表连续时间，如`0 5 * * 1-6 命令`, 代表每周一到周六的凌晨5点0分执行命名。
- `*/n` ： 代表隔多久执行一次， 如`*/10 * * * * 命令`，代表每隔十分钟执行一次。
